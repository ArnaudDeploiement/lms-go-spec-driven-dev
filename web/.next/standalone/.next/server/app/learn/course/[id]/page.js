(()=>{var e={};e.id=77,e.ids=[77],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7447:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),r(2495),r(5509),r(5866);var s=r(3191),a=r(8716),i=r(7922),n=r.n(i),l=r(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["learn",{children:["course",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2495)),"/home/arnaud/project/lms-go/web/app/learn/course/[id]/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,5509)),"/home/arnaud/project/lms-go/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/arnaud/project/lms-go/web/app/learn/course/[id]/page.tsx"],u="/learn/course/[id]/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/learn/course/[id]/page",pathname:"/learn/course/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6113:(e,t,r)=>{Promise.resolve().then(r.bind(r,6877))},6877:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>M});var s=r(326),a=r(7577),i=r(58),n=r(8129),l=r(5047),o=r(1210),d=r(9341),c=r(772),u=r(2643),m=r(2881);let p=(0,m.Z)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),h=(0,m.Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),x=(0,m.Z)("FileQuestion",[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]]),f=(0,m.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var g=r(6343),y=r(6333),v=r(9015),j=r(361),b=r(8998);let N=(0,m.Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),w=({progressValue:e,moduleProgress:t,totalModules:r})=>{if(t&&t.length>0){let e=t.filter(e=>"completed"===e.status).length,s=r&&r>0?r:t.length;if(s>0)return Math.round(e/s*100)}return"number"!=typeof e||Number.isNaN(e)?0:e<=1?Math.round(100*e):Math.round(e)},k=(e,t=[],r)=>({...e,module_progress:t,progress_pct:w({progressValue:e.progress,moduleProgress:t,totalModules:r})}),_={video:p,pdf:h,article:h,quiz:x,scorm:f};function M(){let e=(0,l.useRouter)(),t=(0,l.useParams)(),{user:r,organization:m,isAuthenticated:p}=(0,o.a)(),[x,f]=(0,a.useState)(null),[M,Z]=(0,a.useState)(null),[P,C]=(0,a.useState)(!0),[z,E]=(0,a.useState)(!1),R=t.id,$=async()=>{if(m&&r){E(!0);try{let e=await d.x.createEnrollment(m.id,{course_id:R,user_id:r.id}),t=await d.x.getProgress(m.id,e.id);Z(k(e,t,x?.modules?.length??t.length))}catch(e){console.error("Error enrolling:",e)}finally{E(!1)}}},S=async t=>{if(!M||!m)return;let r=M.module_progress?.find(e=>e.module_id===t.id);if(!(r?.status==="not_started"&&t.order_index>0)){if(!r||"not_started"===r.status)try{await d.x.startModule(m.id,M.id,t.id);let e=await d.x.getProgress(m.id,M.id);Z(t=>t?{...t,module_progress:e,progress_pct:w({progressValue:t.progress,moduleProgress:e,totalModules:x?.modules?.length??e.length})}:t)}catch(e){console.error("Error updating progress:",e)}e.push(`/learn/course/${R}/module/${t.id}`)}},q=e=>{if(!M)return"locked";let t=M.module_progress?.find(t=>t.module_id===e.id);return t?t.status:"not_started"};return P?s.jsx("div",{className:"flex min-h-screen items-center justify-center",children:s.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-blue-600"})}):x?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("header",{className:"border-b bg-white",children:s.jsx("div",{className:"container mx-auto px-4 py-4",children:(0,s.jsxs)(c.z,{variant:"ghost",size:"sm",onClick:()=>e.push("/learn"),className:"mb-4",children:[s.jsx(y.Z,{className:"h-4 w-4 mr-2"}),"Retour au catalogue"]})})}),(0,s.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[s.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,s.jsxs)(u.Zb,{className:"mb-8",children:[s.jsx(u.Ol,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[s.jsx(u.ll,{className:"text-3xl mb-2",children:x.title}),s.jsx(u.SZ,{className:"text-base",children:x.description})]}),s.jsx("div",{className:"ml-4",children:M?(0,s.jsxs)("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Progression"}),(0,s.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[M.progress_pct||0,"%"]})]}):s.jsx(c.z,{onClick:$,disabled:z,children:z?"Inscription...":"S'inscrire"})})]})}),M&&s.jsx(u.aY,{children:s.jsx("div",{className:"h-2 w-full rounded-full bg-gray-200",children:s.jsx(i.E.div,{initial:{width:0},animate:{width:`${M.progress_pct||0}%`},transition:{duration:.5,delay:.2},className:"h-full rounded-full bg-blue-600"})})})]})}),(0,s.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Modules de formation"}),x.modules&&0!==x.modules.length?s.jsx("div",{className:"space-y-4",children:s.jsx(n.M,{children:x.modules.sort((e,t)=>e.order_index-t.order_index).map((e,t)=>{let r=q(e),a="completed"===r,n="in_progress"===r,l=!M||"not_started"===r&&t>0,o=_[e.module_type]||h;return s.jsx(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3,delay:.05*t},children:s.jsx(u.Zb,{className:`
                            transition-all cursor-pointer
                            ${l?"opacity-60":"hover:shadow-lg"}
                            ${n?"border-blue-500 border-2":""}
                            ${a?"border-green-500":""}
                          `,onClick:()=>!l&&S(e),children:s.jsx(u.Ol,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-4 flex-1",children:[s.jsx("div",{className:`
                                  p-3 rounded-lg
                                  ${a?"bg-green-100":"bg-blue-100"}
                                `,children:l?s.jsx(v.Z,{className:"h-6 w-6 text-gray-400"}):a?s.jsx(j.Z,{className:"h-6 w-6 text-green-600"}):s.jsx(o,{className:`h-6 w-6 ${n?"text-blue-600":"text-gray-600"}`})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)(u.ll,{className:"text-xl mb-1",children:["Module ",t+1,": ",e.title]}),s.jsx(u.SZ,{children:e.description}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[e.duration_minutes&&(0,s.jsxs)("span",{className:"flex items-center gap-1 text-sm text-gray-600",children:[s.jsx(b.Z,{className:"h-4 w-4"}),e.duration_minutes," min"]}),s.jsx("span",{className:"text-sm text-gray-600 capitalize",children:e.module_type})]})]})]}),s.jsx("div",{children:l?s.jsx("span",{className:"text-sm text-gray-500",children:"Verrouill\xe9"}):a?s.jsx(j.Z,{className:"h-6 w-6 text-green-600"}):n?s.jsx(N,{className:"h-6 w-6 text-blue-600"}):s.jsx(c.z,{size:"sm",variant:"outline",children:"Commencer"})})]})})})},e.id)})})}):s.jsx(u.Zb,{children:(0,s.jsxs)(u.aY,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(g.Z,{className:"h-16 w-16 text-gray-400 mb-4"}),s.jsx("p",{className:"text-gray-600 text-center",children:"Aucun module disponible pour cette formation"})]})})]})]})]}):s.jsx("div",{className:"flex min-h-screen items-center justify-center",children:s.jsx(u.Zb,{children:(0,s.jsxs)(u.aY,{className:"flex flex-col items-center py-12",children:[s.jsx(g.Z,{className:"h-16 w-16 text-gray-400 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Formation non trouv\xe9e"}),s.jsx(c.z,{className:"mt-4",onClick:()=>e.push("/learn"),children:"Retour au catalogue"})]})})})}},772:(e,t,r)=>{"use strict";r.d(t,{z:()=>d});var s=r(326),a=r(7577),i=r(4214),n=r(9360),l=r(7863);let o=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef(({className:e,variant:t,size:r,asChild:a=!1,...n},d)=>{let c=a?i.g7:"button";return s.jsx(c,{className:(0,l.cn)(o({variant:t,size:r,className:e})),ref:d,...n})});d.displayName="Button"},2643:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>l,SZ:()=>d,Zb:()=>n,aY:()=>c,ll:()=>o});var s=r(326),a=r(7577),i=r(7863);let n=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));n.displayName="Card";let l=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let o=a.forwardRef(({className:e,...t},r)=>s.jsx("h3",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let d=a.forwardRef(({className:e,...t},r)=>s.jsx("p",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));d.displayName="CardDescription";let c=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent",a.forwardRef(({className:e,...t},r)=>s.jsx("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},7863:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i});var s=r(1135),a=r(1009);function i(...e){return(0,a.m6)((0,s.W)(e))}},6343:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(2881).Z)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},361:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(2881).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},8998:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(2881).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},9015:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(2881).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},2495:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/home/arnaud/project/lms-go/web/app/learn/course/[id]/page.tsx#default`)},8129:(e,t,r)=>{"use strict";r.d(t,{M:()=>g});var s=r(326),a=r(7577),i=r(339),n=r(4749),l=r(295),o=r(3965);class d extends a.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function c({children:e,isPresent:t}){let r=(0,a.useId)(),i=(0,a.useRef)(null),n=(0,a.useRef)({width:0,height:0,top:0,left:0}),{nonce:l}=(0,a.useContext)(o._);return(0,a.useInsertionEffect)(()=>{let{width:e,height:s,top:a,left:o}=n.current;if(t||!i.current||!e||!s)return;i.current.dataset.motionPopId=r;let d=document.createElement("style");return l&&(d.nonce=l),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${s}px !important;
            top: ${a}px !important;
            left: ${o}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),(0,s.jsx)(d,{isPresent:t,childRef:i,sizeRef:n,children:a.cloneElement(e,{ref:i})})}let u=({children:e,initial:t,isPresent:r,onExitComplete:i,custom:o,presenceAffectsLayout:d,mode:u})=>{let p=(0,n.h)(m),h=(0,a.useId)(),x=(0,a.useCallback)(e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;i&&i()},[p,i]),f=(0,a.useMemo)(()=>({id:h,initial:t,isPresent:r,custom:o,onExitComplete:x,register:e=>(p.set(e,!1),()=>p.delete(e))}),d?[Math.random(),x]:[r,x]);return(0,a.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[r]),a.useEffect(()=>{r||p.size||!i||i()},[r]),"popLayout"===u&&(e=(0,s.jsx)(c,{isPresent:r,children:e})),(0,s.jsx)(l.O.Provider,{value:f,children:e})};function m(){return new Map}var p=r(6933);let h=e=>e.key||"";function x(e){let t=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&t.push(e)}),t}var f=r(2482);let g=({children:e,custom:t,initial:r=!0,onExitComplete:l,presenceAffectsLayout:o=!0,mode:d="sync",propagate:c=!1})=>{let[m,g]=(0,p.oO)(c),y=(0,a.useMemo)(()=>x(e),[e]),v=c&&!m?[]:y.map(h),j=(0,a.useRef)(!0),b=(0,a.useRef)(y),N=(0,n.h)(()=>new Map),[w,k]=(0,a.useState)(y),[_,M]=(0,a.useState)(y);(0,f.L)(()=>{j.current=!1,b.current=y;for(let e=0;e<_.length;e++){let t=h(_[e]);v.includes(t)?N.delete(t):!0!==N.get(t)&&N.set(t,!1)}},[_,v.length,v.join("-")]);let Z=[];if(y!==w){let e=[...y];for(let t=0;t<_.length;t++){let r=_[t],s=h(r);v.includes(s)||(e.splice(t,0,r),Z.push(r))}"wait"===d&&Z.length&&(e=Z),M(x(e)),k(y);return}let{forceRender:P}=(0,a.useContext)(i.p);return(0,s.jsx)(s.Fragment,{children:_.map(e=>{let a=h(e),i=(!c||!!m)&&(y===_||v.includes(a));return(0,s.jsx)(u,{isPresent:i,initial:(!j.current||!!r)&&void 0,custom:i?void 0:t,presenceAffectsLayout:o,mode:d,onExitComplete:i?void 0:()=>{if(!N.has(a))return;N.set(a,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(null==P||P(),M(b.current),c&&(null==g||g()),l&&l())},children:e},a)})})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[126,432,155,711],()=>r(7447));module.exports=s})();