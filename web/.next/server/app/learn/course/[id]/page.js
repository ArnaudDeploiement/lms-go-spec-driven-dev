(()=>{var e={};e.id=77,e.ids=[77],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9107:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),s(2495),s(5509),s(5866);var r=s(3191),a=s(8716),i=s(7922),n=s.n(i),l=s(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["learn",{children:["course",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,2495)),"/home/arnaud/project/lms-go/web/app/learn/course/[id]/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5509)),"/home/arnaud/project/lms-go/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/arnaud/project/lms-go/web/app/learn/course/[id]/page.tsx"],u="/learn/course/[id]/page",h={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/learn/course/[id]/page",pathname:"/learn/course/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6113:(e,t,s)=>{Promise.resolve().then(s.bind(s,656))},656:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>H});var r=s(326),a=s(7577),i=s(58),n=s(339),l=s(4749),o=s(295),d=s(3965);class c extends a.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function u({children:e,isPresent:t}){let s=(0,a.useId)(),i=(0,a.useRef)(null),n=(0,a.useRef)({width:0,height:0,top:0,left:0}),{nonce:l}=(0,a.useContext)(d._);return(0,a.useInsertionEffect)(()=>{let{width:e,height:r,top:a,left:o}=n.current;if(t||!i.current||!e||!r)return;i.current.dataset.motionPopId=s;let d=document.createElement("style");return l&&(d.nonce=l),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${r}px !important;
            top: ${a}px !important;
            left: ${o}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),(0,r.jsx)(c,{isPresent:t,childRef:i,sizeRef:n,children:a.cloneElement(e,{ref:i})})}let h=({children:e,initial:t,isPresent:s,onExitComplete:i,custom:n,presenceAffectsLayout:d,mode:c})=>{let h=(0,l.h)(m),x=(0,a.useId)(),p=(0,a.useCallback)(e=>{for(let t of(h.set(e,!0),h.values()))if(!t)return;i&&i()},[h,i]),f=(0,a.useMemo)(()=>({id:x,initial:t,isPresent:s,custom:n,onExitComplete:p,register:e=>(h.set(e,!1),()=>h.delete(e))}),d?[Math.random(),p]:[s,p]);return(0,a.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[s]),a.useEffect(()=>{s||h.size||!i||i()},[s]),"popLayout"===c&&(e=(0,r.jsx)(u,{isPresent:s,children:e})),(0,r.jsx)(o.O.Provider,{value:f,children:e})};function m(){return new Map}var x=s(6933);let p=e=>e.key||"";function f(e){let t=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&t.push(e)}),t}var y=s(2482);let g=({children:e,custom:t,initial:s=!0,onExitComplete:i,presenceAffectsLayout:o=!0,mode:d="sync",propagate:c=!1})=>{let[u,m]=(0,x.oO)(c),g=(0,a.useMemo)(()=>f(e),[e]),j=c&&!u?[]:g.map(p),v=(0,a.useRef)(!0),b=(0,a.useRef)(g),N=(0,l.h)(()=>new Map),[w,_]=(0,a.useState)(g),[k,P]=(0,a.useState)(g);(0,y.L)(()=>{v.current=!1,b.current=g;for(let e=0;e<k.length;e++){let t=p(k[e]);j.includes(t)?N.delete(t):!0!==N.get(t)&&N.set(t,!1)}},[k,j.length,j.join("-")]);let M=[];if(g!==w){let e=[...g];for(let t=0;t<k.length;t++){let s=k[t],r=p(s);j.includes(r)||(e.splice(t,0,s),M.push(s))}"wait"===d&&M.length&&(e=M),P(f(e)),_(g);return}let{forceRender:E}=(0,a.useContext)(n.p);return(0,r.jsx)(r.Fragment,{children:k.map(e=>{let a=p(e),n=(!c||!!u)&&(g===k||j.includes(a));return(0,r.jsx)(h,{isPresent:n,initial:(!v.current||!!s)&&void 0,custom:n?void 0:t,presenceAffectsLayout:o,mode:d,onExitComplete:n?void 0:()=>{if(!N.has(a))return;N.set(a,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(null==E||E(),P(b.current),c&&(null==m||m()),i&&i())},children:e},a)})})};var j=s(5047),v=s(1210),b=s(9341),N=s(772),w=s(3071),_=s(2881);let k=(0,_.Z)("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),P=(0,_.Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),M=(0,_.Z)("FileQuestion",[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]]),E=(0,_.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var Z=s(6343);let C=(0,_.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),z=(0,_.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var R=s(361),$=s(8998);let q=(0,_.Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),S={video:k,pdf:P,article:P,quiz:M,scorm:E};function H(){let e=(0,j.useRouter)(),t=(0,j.useParams)(),{user:s,organization:n,isAuthenticated:l}=(0,v.a)(),[o,d]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[h,m]=(0,a.useState)(!0),[x,p]=(0,a.useState)(!1),f=t.id,y=async()=>{if(n){p(!0);try{let e=await b.x.enrollInCourse(n.id,f);u(e)}catch(e){console.error("Error enrolling:",e)}finally{p(!1)}}},_=async t=>{if(!c||!n)return;let s=c.module_progress?.find(e=>e.module_id===t.id);if(!(s?.status==="not_started"&&t.order_index>0)){if(!s||"not_started"===s.status)try{await b.x.updateProgress(n.id,c.id,t.id,"in_progress")}catch(e){console.error("Error updating progress:",e)}e.push(`/learn/course/${f}/module/${t.id}`)}},k=e=>{if(!c)return"locked";let t=c.module_progress?.find(t=>t.module_id===e.id);return t?t.status:"not_started"};return h?r.jsx("div",{className:"flex min-h-screen items-center justify-center",children:r.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-blue-600"})}):o?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("header",{className:"border-b bg-white",children:r.jsx("div",{className:"container mx-auto px-4 py-4",children:(0,r.jsxs)(N.z,{variant:"ghost",size:"sm",onClick:()=>e.push("/learn"),className:"mb-4",children:[r.jsx(C,{className:"h-4 w-4 mr-2"}),"Retour au catalogue"]})})}),(0,r.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[r.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,r.jsxs)(w.Zb,{className:"mb-8",children:[r.jsx(w.Ol,{children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx(w.ll,{className:"text-3xl mb-2",children:o.title}),r.jsx(w.SZ,{className:"text-base",children:o.description})]}),r.jsx("div",{className:"ml-4",children:c?(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Progression"}),(0,r.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[c.progress_pct||0,"%"]})]}):r.jsx(N.z,{onClick:y,disabled:x,children:x?"Inscription...":"S'inscrire"})})]})}),c&&r.jsx(w.aY,{children:r.jsx("div",{className:"h-2 w-full rounded-full bg-gray-200",children:r.jsx(i.E.div,{initial:{width:0},animate:{width:`${c.progress_pct||0}%`},transition:{duration:.5,delay:.2},className:"h-full rounded-full bg-blue-600"})})})]})}),(0,r.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:[r.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Modules de formation"}),o.modules&&0!==o.modules.length?r.jsx("div",{className:"space-y-4",children:r.jsx(g,{children:o.modules.sort((e,t)=>e.order_index-t.order_index).map((e,t)=>{let s=k(e),a="completed"===s,n="in_progress"===s,l=!c||"not_started"===s&&t>0,o=S[e.module_type]||P;return r.jsx(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3,delay:.05*t},children:r.jsx(w.Zb,{className:`
                            transition-all cursor-pointer
                            ${l?"opacity-60":"hover:shadow-lg"}
                            ${n?"border-blue-500 border-2":""}
                            ${a?"border-green-500":""}
                          `,onClick:()=>!l&&_(e),children:r.jsx(w.Ol,{children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-start gap-4 flex-1",children:[r.jsx("div",{className:`
                                  p-3 rounded-lg
                                  ${a?"bg-green-100":"bg-blue-100"}
                                `,children:l?r.jsx(z,{className:"h-6 w-6 text-gray-400"}):a?r.jsx(R.Z,{className:"h-6 w-6 text-green-600"}):r.jsx(o,{className:`h-6 w-6 ${n?"text-blue-600":"text-gray-600"}`})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)(w.ll,{className:"text-xl mb-1",children:["Module ",t+1,": ",e.title]}),r.jsx(w.SZ,{children:e.description}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[e.duration_minutes&&(0,r.jsxs)("span",{className:"flex items-center gap-1 text-sm text-gray-600",children:[r.jsx($.Z,{className:"h-4 w-4"}),e.duration_minutes," min"]}),r.jsx("span",{className:"text-sm text-gray-600 capitalize",children:e.module_type})]})]})]}),r.jsx("div",{children:l?r.jsx("span",{className:"text-sm text-gray-500",children:"Verrouill\xe9"}):a?r.jsx(R.Z,{className:"h-6 w-6 text-green-600"}):n?r.jsx(q,{className:"h-6 w-6 text-blue-600"}):r.jsx(N.z,{size:"sm",variant:"outline",children:"Commencer"})})]})})})},e.id)})})}):r.jsx(w.Zb,{children:(0,r.jsxs)(w.aY,{className:"flex flex-col items-center justify-center py-12",children:[r.jsx(Z.Z,{className:"h-16 w-16 text-gray-400 mb-4"}),r.jsx("p",{className:"text-gray-600 text-center",children:"Aucun module disponible pour cette formation"})]})})]})]})]}):r.jsx("div",{className:"flex min-h-screen items-center justify-center",children:r.jsx(w.Zb,{children:(0,r.jsxs)(w.aY,{className:"flex flex-col items-center py-12",children:[r.jsx(Z.Z,{className:"h-16 w-16 text-gray-400 mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Formation non trouv\xe9e"}),r.jsx(N.z,{className:"mt-4",onClick:()=>e.push("/learn"),children:"Retour au catalogue"})]})})})}},2495:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`/home/arnaud/project/lms-go/web/app/learn/course/[id]/page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[126,287,97],()=>s(9107));module.exports=r})();